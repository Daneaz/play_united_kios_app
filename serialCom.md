PC售币版通信协议1205
一、功能
1，PC发送币数，控制板按数出币
2，控制板收到投币，如实发给PC
3，控制板没有帐目，上排显示投币数，下排显示出币数
4，PC可以打开/关闭控制板的投币器与纸钞机

二、控制协议
1，通信参数：
[115200，N，8，1]
2，PC至控制板的数据格式：
[帧头0xFE][指令][DATA0..3][校验][帧尾0xEF]
3，控制板至PC的数据格式：
[帧头0xFD][指令][状态][故障][DATA0..4][校验][帧尾0xDF]
4，校验的计算
校验=[指令]^...^[数据N]，如果[校验]>=0xE0，[校验]-=0x30
5，数值的计算
结果=DATA0*1000+DATA1*100+DATA2*10+DATA3*1，或
结果=DATA0*10000+DATA1*1000+DATA2*100+DATA3*10+DATA4*1

三、指令说明
1、控制指令
指令：0x01
说明：控制投币器与纸钞机的开/关
方向：PC->控制板
发送：
数值：0关闭投币器与纸钞机，1只打开投币器，2只打开纸钞机，3打开投币器与纸钞机
例：
FE 01 00 00 00 02 03 EF //只打开纸钞机
回复：
状态：0关闭投币器与纸钞机，1只打开投币器，2只打开纸钞机，3打开投币器与纸钞机
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：空
例：
FD 01 01 00 00 00 00 00 00 00 DF //回复已打开投币器

2、兑币指令
指令：0x02
说明：发送出币数值，先回复正在出币，出币完成后回复已出总数，出币过程中（无法自定义出币数）
不接受新的数值。
方向：PC->控制板
发送：
数值：出币数值
例：
FE 02 00 00 00 01 03 EF //表示出币1个
FE 02 00 00 01 03 00 EF //表示出币13个
FE 02 00 00 01 00 03 EF //表示出币10个
FE 02 00 00 02 05 05 EF //表示出币25个
FE 02 00 00 05 00 07 EF //表示出币50个
FE 02 00 01 00 00 03 EF //表示出币100个
FE 02 00 01 03 04 04 EF //表示出币134个
回复：
状态：出币状态，0正在出币，1出币完成
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：已出币数
例：
FD 02 00 00 00 00 00 00 00 02 DF //回复正在出币
FD 02 01 01 00 00 00 00 00 02 DF //回复出币完成，并且存币不足，已出0个币

3、投币指令
指令：0x03
说明：有投币时，会主动上传这个消息
方向：控制板->PC
发送：
状态：0投入硬币，1投入纸币
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：当前金额
例：
FD 03 00 00 00 00 00 00 01 02 DF //投入硬币1枚
FD 03 01 00 00 00 00 00 01 03 DF //投入纸币1元
回复：
数值：空
例：
FE 03 00 00 00 00 03 EF

4、查询当前存币数；
指令：0x04
说明：每次购币/开机的时候PC主动查询当前存币数
方向：PC->控制板
发送：
数值：空
例：
FE 04 00 00 00 00 04 EF
回复：
状态：0
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：当前存币
例：
FD 04 00 00 00 01 00 00 00 05 DF //当前存币数为1000枚

5、设置总存币数
指令：0x05
说明：每次新增加的时候PC主动设置当前存币数，以前的数值不作保留(目前只能测出设置5000有效）
方向：PC->控制板
发送：
数值：总币数
例：
FE 05 05 00 00 00 00 EF // 5000枚
回复：
状态：0
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：当前存币
例：
FD 05 00 00 00 05 00 00 00 00 DF //当前存币数为5000枚

6、清币
指令：0x06
说明：清出所有的币
方向：PC->控制板
发送：
数值：0
例：
FE 06 00 00 00 00 06 EF
回复：
状态：0
故障：故障代码，0无故障，1存币不足，2纸钞机故障
数值：清出币数
例：
FD 06 00 00 00 00 06 00 00 00 DF //当前清出币数为600枚
